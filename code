import asyncio
import time
import random
from pyrogram import Client, filters
from pyrogram.errors import FloodWait

# ---- YOUR CREDENTIALS ----
API_ID = 
API_HASH =
PHONE_NUMBER = 

print("â³ Starting Bot with Roast & Funny Commands...", flush=True)

# Initialize Client
app = Client("my_pyro_bot", api_id=API_ID, api_hash=API_HASH, phone_number=PHONE_NUMBER)

# ---- HELPER FUNCTION ----
async def safe_edit(message, text):
    """Edits message safely with FloodWait protection"""
    try:
        await message.edit_text(text)
    except FloodWait as e:
        await asyncio.sleep(e.value)
        await message.edit_text(text)
    except Exception as e:
        print(f"Error: {e}")

# ================= ğŸ”¥ ROAST & FUNNY (NEW) =================

@app.on_message(filters.command("roast", prefixes=".") & filters.me)
async def roast_handler(client, message):
    """Sends a savage roast"""
    roasts = [
        "You're the reason they put instructions on shampoo bottles.",
        "You have something on your chin... no, the 3rd one down.",
        "I'd agree with you but then we'd both be wrong.",
        "You bring everyone so much joy... when you leave the room.",
        "I'm not saying I hate you, but I would unplug your life support to charge my phone.",
        "You are like a cloud. When you disappear, it's a beautiful day.",
        "Iâ€™d explain it to you but I left my English-to-Idiot dictionary at home.",
        "Your secrets are always safe with me. I never even listen when you tell me them."
    ]
    await safe_edit(message, f"ğŸ”¥ **{random.choice(roasts)}** ğŸ”¥")

@app.on_message(filters.command("funny", prefixes=".") & filters.me)
async def funny_handler(client, message):
    """Tells a random joke"""
    jokes = [
        "Why don't scientists trust atoms?\nBecause they make up everything!",
        "I told my wife she was drawing her eyebrows too high.\nShe looked surprised.",
        "Parallel lines have so much in common. Itâ€™s a shame theyâ€™ll never meet.",
        "I threw a boomerang a few years ago. I now live in constant fear.",
        "My wife told me to stop impersonating a flamingo. I had to put my foot down.",
        "I'm reading a book on anti-gravity. It's impossible to put down!",
        "What do you call a fake noodle?\nAn Impasta!"
    ]
    await safe_edit(message, f"ğŸ˜‚ **{random.choice(jokes)}**")

# ================= ğŸ‘ APPRECIATE & WELCOME =================

@app.on_message(filters.command("appreciate", prefixes=".") & filters.me)
async def appreciate_handler(client, message):
    """Appreciation Animation"""
    await safe_edit(message, "ğŸ‘")
    await asyncio.sleep(0.3)
    await safe_edit(message, "ğŸ‘ğŸ‘")
    await asyncio.sleep(0.3)
    await safe_edit(message, "ğŸ‘ğŸ‘ğŸ‘")
    await asyncio.sleep(0.3)
    await safe_edit(message, "ğŸ‘ **Great Job!**")
    await asyncio.sleep(0.5)
    await safe_edit(message, "ğŸŒŸ **You are Amazing!** ğŸŒŸ")
    await asyncio.sleep(0.5)
    await safe_edit(message, "ğŸ’– **Appreciate !** ğŸ’–")

@app.on_message(filters.command("wlc", prefixes=".") & filters.me)
async def wlc_handler(client, message):
    """Welcome Animation"""
    await safe_edit(message, "ğŸ‘‹")
    await asyncio.sleep(0.5)
    await safe_edit(message, "ğŸ‘‹ **Welcome!**")
    await asyncio.sleep(0.5)
    await safe_edit(message, "âœ¨ **Welcome to the Chat!** âœ¨")
    await asyncio.sleep(0.5)
    await safe_edit(message, "âœ¨ **WLCOM!!!!** ")

# ================= ğŸ˜‚ FUNNY ANIMATIONS =================

@app.on_message(filters.command("laugh", prefixes=".") & filters.me)
async def laugh_handler(client, message):
    faces = ["ğŸ˜‚", "ğŸ¤£", "ğŸ˜¹", "ğŸ˜†", "ğŸ˜‚", "ğŸ¤£", "ğŸ’€"]
    for face in faces:
        await safe_edit(message, face)
        await asyncio.sleep(0.2)
    await safe_edit(message, "ğŸ’€ **HEHEHEATHU** ğŸ’€")

@app.on_message(filters.command("flower", prefixes=".") & filters.me)
async def flower_handler(client, message):
    await safe_edit(message, "ğŸƒâ€â™‚ï¸")
    await asyncio.sleep(0.5)
    await safe_edit(message, "ğŸƒâ€â™‚ï¸ ğŸŒ²")
    await asyncio.sleep(0.5)
    await safe_edit(message, "ğŸƒâ€â™‚ï¸ ğŸ¤ ğŸŒ¹")
    await asyncio.sleep(0.5)
    await safe_edit(message, "ğŸƒâ€â™‚ï¸ ğŸ¤ ğŸ’")
    await asyncio.sleep(0.5)
    await safe_edit(message, "ğŸƒâ€â™‚ï¸ ğŸ’")
    await asyncio.sleep(0.5)
    await safe_edit(message, "ğŸ")
    await asyncio.sleep(0.5)
    await safe_edit(message, "ğŸ’ **For You!** ğŸ’")

@app.on_message(filters.command("rose", prefixes=".") & filters.me)
async def rose_handler(client, message):
    await safe_edit(message, "ğŸŒ±")
    await asyncio.sleep(0.5)
    await safe_edit(message, "ğŸŒ¿")
    await asyncio.sleep(0.5)
    await safe_edit(message, "âš˜")
    await asyncio.sleep(0.5)
    await safe_edit(message, "ğŸŒ¹")
    await asyncio.sleep(0.5)
    await safe_edit(message, "ğŸŒ¹ FOR UHH")

# ================= ğŸŒ… GREETINGS =================

@app.on_message(filters.command("gm", prefixes=".") & filters.me)
async def gm_handler(client, message):
    await safe_edit(message, "ğŸŒ‘ **Sleeping...**")
    await asyncio.sleep(1)
    await safe_edit(message, "ğŸŒ„ **Sun is rising...**")
    await asyncio.sleep(1)
    await safe_edit(message, "â˜€ï¸ **Good Morning!** â˜€ï¸")

@app.on_message(filters.command("gn", prefixes=".") & filters.me)
async def gn_handler(client, message):
    await safe_edit(message, "ğŸŒ‡ **Sun is setting...**")
    await asyncio.sleep(1)
    await safe_edit(message, "ğŸ˜´ **Good Night!** ğŸ’¤")

@app.on_message(filters.command("hi", prefixes=".") & filters.me)
async def hi_handler(client, message):
    await safe_edit(message, "ğŸ‘‹")
    await asyncio.sleep(0.5)
    await safe_edit(message, "ğŸ‘‹ **Hello! How are you?**")

@app.on_message(filters.command("bye", prefixes=".") & filters.me)
async def bye_handler(client, message):
    await safe_edit(message, "ğŸ‘‹ **Bye...**")
    await asyncio.sleep(0.5)
    await safe_edit(message, "ğŸš¶â€â™‚ï¸ **Leaving...**")
    await asyncio.sleep(0.5)
    await safe_edit(message, "ğŸšª **Gone.**")

@app.on_message(filters.command("thx", prefixes=".") & filters.me)
async def thx_handler(client, message):
    await safe_edit(message, "ğŸ™ **Thank You!** ğŸ’–")

# ================= âœï¸ TEXT MAGIC =================

@app.on_message(filters.command("type", prefixes=".") & filters.me)
async def type_handler(client, message):
    if len(message.command) < 2: return
    text = message.text.split(None, 1)[1]
    current_text = ""
    for char in text:
        current_text += char
        await safe_edit(message, f"{current_text} ğŸ–Šï¸")
        await asyncio.sleep(0.1)
    await safe_edit(message, current_text)

@app.on_message(filters.command("breathe", prefixes=".") & filters.me)
async def breathe_handler(client, message):
    if len(message.command) < 2: return
    text = message.text.split(None, 1)[1]
    spaced = " ".join(list(text))
    await safe_edit(message, f"âœ¨ {spaced} âœ¨")
    await asyncio.sleep(0.5)
    await safe_edit(message, f"**{text}**")

@app.on_message(filters.command("box", prefixes=".") & filters.me)
async def box_handler(client, message):
    if len(message.command) < 2: return
    text = message.text.split(None, 1)[1]
    lines = [f"â•”{'â•' * (len(text) + 2)}â•—", f"â•‘ {text} â•‘", f"â•š{'â•' * (len(text) + 2)}â•"]
    res = ""
    for line in lines:
        res += line + "\n"
        await safe_edit(message, res)
        await asyncio.sleep(0.2)

@app.on_message(filters.command("scramble", prefixes=".") & filters.me)
async def scramble_handler(client, message):
    if len(message.command) < 2: return
    text = message.text.split(None, 1)[1]
    chars = "!@#$%^&*"
    for _ in range(3):
        junk = "".join(random.choice(chars) for _ in range(len(text)))
        await safe_edit(message, f"ğŸ” {junk}")
        await asyncio.sleep(0.2)
    await safe_edit(message, f"ğŸ”“ **{text}**")

@app.on_message(filters.command("rev", prefixes=".") & filters.me)
async def rev_handler(client, message):
    if len(message.command) < 2: return
    text = message.text.split(None, 1)[1]
    await safe_edit(message, f"ğŸ”„ {text[::-1]}")

# ================= ğŸ“ TOOLS =================

@app.on_message(filters.command("ping", prefixes=".") & filters.me)
async def ping_handler(client, message):
    start = time.time()
    await safe_edit(message, "ğŸ“ **Pong!**")
    end = time.time()
    ms = (end - start) * 1000
    await safe_edit(message, f"ğŸ“ **Pong!**\nğŸ“¶ `{ms:.2f}ms`")

@app.on_message(filters.command("spam", prefixes=".") & filters.me)
async def spam_handler(client, message):
    if len(message.command) < 3: return
    try:
        count = int(message.command[1])
        text = message.text.split(None, 2)[2]
        if count > 20:
            await safe_edit(message, "âŒ **Max Limit: 20**")
            return
        await message.delete()
        for _ in range(count):
            await client.send_message(message.chat.id, text)
            await asyncio.sleep(0.3)
    except: pass

@app.on_message(filters.command("magic", prefixes=".") & filters.me)
async def magic_handler(client, message):
    await safe_edit(message, "ğŸ©")
    await asyncio.sleep(1)
    await safe_edit(message, "ğŸ° **TADA!**")

@app.on_message(filters.command("help", prefixes=".") & filters.me)
async def help_handler(client, message):
    msg = (
        "ğŸ¤– **BOT MENU** ğŸ¤–\n\n"
        "ğŸ”¥ **Jokes:** `.roast`, `.funny`\n"
        "ğŸ‘ **Love:** `.appreciate`, `.wlc`\n"
        "ğŸ˜‚ **Fun:** `.laugh`, `.flower`, `.rose`\n"
        "ğŸ‘‹ **Greet:** `.hi`, `.bye`, `.thx`, `.gm`, `.gn`\n"
        "âœï¸ **Text:** `.type`, `.breathe`, `.box`, `.scramble`\n"
        "ğŸ§¨ **Tools:** `.spam 5 Text`, `.magic`, `.ping`"
    )
    await safe_edit(message, msg)

# Start Client
print("âœ… Bot Started! Try typing .roast")
app.run()
